<p class="alert alert-info">
    Taint is:
    <code><%= escapeHTML page.dom.data_flow_sink.first.taint.inspect %></code>
</p>

<table class="table table-condensed">
    <tr>
        <th>#</th>
        <th>Object</th>
        <th>Function</th>
        <th></th>
    </tr>
    <% page.dom.data_flow_sink.each.with_index do |sink, i| %>
        <tr
        id="<%= id %>-data_flow_sinks-<%= i %>"
        >
            <th>
                <strong>
                    <a href="<%= id_to_location id %>/data_flow_sinks/<%= i %>">
                        <%= i %>
                    </a>
                </strong>
            </th>
            <td>
                <code><%= sink.object %></code>
            </td>
            <td>
                <code><%= sink.function %></code>
            </td>
            <td>
                <a data-toggle="collapse" href="#<%= id %>-data_flow_sinks-<%= i %>-more"
                   class="btn btn-info btn-xs">
                    More
                </a>
            </td>
        </tr>
        <tr id="<%= id %>-data_flow_sinks-<%= i %>-more" class="panel-collapse collapse">
            <td colspan="4" class="borderless">
                <ul class="nav nav-tabs">
                    <li class="active">
                        <a href="<%= id_to_location id %>/data_flow_sinks/<%= i %>/more/arguments">
                            Arguments
                        </a>
                    </li>

                    <% if !sink.source.to_s.empty? %>
                        <li>
                            <a href="<%= id_to_location id %>/data_flow_sinks/<%= i %>/more/source">
                                Source
                            </a>
                        </li>
                    <% end %>

                    <% if sink.trace.any? %>
                        <li>
                            <a href="<%= id_to_location id %>/data_flow_sinks/<%= i %>/more/stacktrace">
                                Stacktrace
                            </a>
                        </li>
                    <% end %>

                </ul>

                <div class="tab-content">
                    <div class="tab-pane active" id="<%= id %>-data_flow_sinks-<%= i %>-more-arguments">
                        <%= erb 'issue/page/sink/data_flow/arguments.erb',
                                id:   "#{id}-data_flow_sinks-#{i}-more",
                                sink: sink
                        %>
                    </div>

                    <% if !sink.source.to_s.empty? %>
                        <div class="tab-pane" id="<%= id %>-data_flow_sinks-<%= i %>-more-source">
                            <%= erb 'issue/page/sink/data_flow/source.erb',
                                    id:     "#{id}-data_flow_sinks-#{i}-more",
                                    source: sink.source
                            %>
                        </div>
                    <% end %>

                    <% if sink.trace.any? %>
                        <div class="tab-pane" id="<%= id %>-data_flow_sinks-<%= i %>-more-stacktrace">
                            <%= erb 'issue/page/sink/trace/table.erb',
                                    id:    "#{id}-data_flow_sinks-#{i}-more",
                                    trace: sink.trace,
                                    page:  page
                            %>
                        </div>
                    <% end %>
                </div>

            </td>
        </tr>
    <% end %>
</table>

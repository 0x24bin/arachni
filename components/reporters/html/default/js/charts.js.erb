function index_to_shortname( index ){
    return <%= graph_data[:issues_shortnames].to_json %>[index];
}

function index_to_severity( index ){
    return <%= graph_data[:severity_for_issue].to_json %>[index_to_shortname(index)];
}

jQuery(function ($) {
    c3.generate({
        bindto: '#chart-issues',
        data: {
            x : 'x',
            columns: [
                <%= (['x'] + graph_data[:trusted_issues].keys).to_json %>,
                <%= (['Trusted'] + graph_data[:trusted_issues].values).to_json %>,
                <%= (['Untrusted'] + graph_data[:untrusted_issues].values).to_json %>
            ],
            type: 'bar',
            groups: [
                ['Trusted', 'Untrusted']
            ],
            onclick: function (d) {
                goToLocation(
                    'issues/' + d.name.toLowerCase() +
                    '/severity/' + index_to_severity(d.x) + '/' +
                    index_to_shortname(d.x)
                )
            }
        },
        axis: {
            x: {
                type: 'category' // this needed to load string x value
            }
        }
    });

    c3.generate({
        bindto: '#chart-trust',
        data: {
            type: 'pie',
            columns: <%= graph_data[:trust].to_a.to_json %>
        },
        pie: {
            onclick: function (d) { goToLocation( 'issues/' + d.id.toLowerCase() ) }
        },
        color: {
            pattern: [ '#1f77b4', '#d62728' ]
        }
    });

    c3.generate({
        bindto: '#chart-elements',
        data: {
            type: 'pie',
            columns: <%= graph_data[:elements].select { |_, cnt| cnt > 0 }.to_a.to_json %>
        }
    });

    c3.generate({
        bindto: '#chart-severities',
        data: {
            type: 'pie',
            columns: <%= graph_data[:severities].select { |_, cnt| cnt > 0 }.to_a.to_json %>
        },
        color: {
            pattern: [ '#d62728', '#ff7f0e', '#ffbb78', '#1f77b4' ]
        }
    });

});
